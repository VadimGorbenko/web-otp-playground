<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Web otp playground</title>
</head>

<body>
  <input type="text" autocomplete="one-time-code" inputmode="numeric" />
  <button type="button" id="start">Start</button>
  <button type="button" id="abort">Abort</button>
  <script>
    const ac = new AbortController();
    start.addEventListener('click', function(){ 
      if ('OTPCredential' in window) {
        const input = document.querySelector('input[autocomplete="one-time-code"]');

        const codePromise = navigator.credentials.get({
          otp: {
            transport: ['sms']
          },
          signal: ac.signal
        })
  
        codePromise
        .then(function(otp){
          console.log(`code is ${otp.code}`)
          input.value = otp.code;
          //if (form) form.submit();
        }).catch(err => {
          console.log(err);
        });
      }
    })
    
    abort.addEventListener('click', function(){
      ac.abort()
    })
  </script>
</body>

</html>